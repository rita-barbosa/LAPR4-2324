@startuml US1005_SD

skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false

autonumber

title [US1005 - Sequence Diagram Split]

actor "Customer Manager" as CM
participant "<<presentation>>\n:ListJobOpeningApplicationsUI" as UI
participant "<<application>>\n:ListJobOpeningApplicationsController" as CTRL
participant "<<persistence>>\n:PersistenceContext" as Persistence
participant "<<factory>>\n:RepositoryFactory" as RepositorySingleton
database "<<repository>>\n:JobOpeningRepository" as JobOpeningRepository
'participant "<<factory>>\n:JobOpeningFactory" as JobOpeningFactory
'participant "<<domain>>\n:JobOpening" as JobOpening
database "<<repository>>\n:ApplicationRepository" as ApplicationRepository
'participant "<<factory>>\n:ApplicationFactory" as ApplicationFactory
'participant "<<domain>>\n:Application" as Application

activate CM

CM -> UI : asks to list all the applications for job opening
activate UI

UI -> CTRL : create()

activate CTRL
deactivate CTRL


UI -> CTRL: getJobOpeningList()
activate CTRL

    CTRL -> Persistence : getInstance()
    activate Persistence

    Persistence --> CTRL: repositories
    deactivate Persistence

    CTRL -> RepositorySingleton : getJobOpeningRepository()
    activate RepositorySingleton

    RepositorySingleton -> JobOpeningRepository : create()
    activate JobOpeningRepository
    deactivate JobOpeningRepository

    RepositorySingleton --> CTRL: JobOpeningRepository
    deactivate RepositorySingleton

    CTRL -> JobOpeningRepository : getJobOpeningList()
    activate JobOpeningRepository

    JobOpeningRepository --> CTRL : jobOpeningList
    deactivate JobOpeningRepository

    |||
        CTRL -> CTRL : toDTO(jobOpeningList)
        'activate CTRL

            ref over CTRL
                Convert job Opening List to DTO
            end ref

        'CTRL --> CTRL : jobOpeningListDTO
        'deactivate CTRL

        CTRL --> UI : jobOpeningListDTO

    deactivate CTRL

UI --> CM : shows the job opening with applications and asks to select one
deactivate UI

CM -> UI : selects the job opening
activate UI

UI -> CTRL: getApplicationsList()
activate CTRL

    CTRL -> RepositorySingleton : getApplicationsRepository()
    activate RepositorySingleton

    RepositorySingleton -> ApplicationRepository : create()

    activate ApplicationRepository
    deactivate ApplicationRepository

    RepositorySingleton --> CTRL: ApplicationRepository
    deactivate RepositorySingleton

    CTRL -> ApplicationRepository : getApplicationsList(jobOpening)
    activate ApplicationRepository

    ApplicationRepository --> CTRL : applicationsList
    deactivate ApplicationRepository

    |||
        CTRL -> CTRL : toDTO(applicationsList)
        'activate CTRL

            ref over CTRL
                Convert applications List to DTO
            end ref

        'CTRL --> CTRL : applicationsListDTO
        'deactivate CTRL

        CTRL --> UI : applicationsListDTO

    deactivate CTRL


UI --> CM : shows the applications list
deactivate UI

deactivate CM



@enduml

